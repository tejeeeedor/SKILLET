<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Oficial - Skillet</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- 1. ESTILOS BASE --- */
        @import url('https://fonts.googleapis.com/css2?family=Teko:wght@400;600&family=Roboto:wght@400;700&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: #121214; color: #cccccc; font-family: 'Roboto', sans-serif; line-height: 1.6; }

        /* --- HEADER --- */
        header { background: linear-gradient(to bottom, #5a0b0b, #380202); border-bottom: 3px solid #e10600; position: sticky; top: 0; z-index: 1000; }
        .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }
        .navbar { display: flex; justify-content: space-between; align-items: center; height: 70px; }
        .logo { font-family: 'Teko', sans-serif; font-size: 38px; font-weight: 600; color: #fff; text-transform: uppercase; letter-spacing: 2px; }
        .nav-links { display: flex; list-style: none; }
        .nav-links a { color: #d1d1d1; text-decoration: none; font-size: 14px; font-weight: 700; padding: 0 20px; text-transform: uppercase; cursor: pointer; }
        .nav-links a:hover { color: #fff; border-bottom: 3px solid #e10600; }
        .cart-count { background: #e10600; color: #fff; border-radius: 50%; padding: 2px 7px; font-size: 0.8em; margin-left: 5px; }

        /* --- BUSCADOR Y FILTROS --- */
        .shop-controls { background: #1a1a1a; padding: 30px; border: 1px solid #333; margin-bottom: 40px; text-align: center; }
        .search-box { width: 100%; max-width: 400px; padding: 12px; margin-bottom: 20px; background: #0d0d0f; border: 1px solid #e10600; color: white; font-size: 1em; }
        .filter-btn { background: transparent; color: #ccc; border: 1px solid #444; padding: 8px 20px; margin: 5px; font-family: 'Teko', sans-serif; font-size: 1.3em; cursor: pointer; text-transform: uppercase; transition: 0.3s; }
        .filter-btn.active, .filter-btn:hover { background: #e10600; color: white; border-color: #e10600; }

        /* --- GRID DE PRODUCTOS --- */
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 30px; }
        .product-card { background: #1a1b1e; border-top: 3px solid #333; transition: 0.3s; display: flex; flex-direction: column; overflow: hidden; }
        .product-card:hover { transform: translateY(-5px); border-top-color: #e10600; }
        .product-img-container { width: 100%; height: 280px; background: #fff; }
        .product-img-container img { width: 100%; height: 100%; object-fit: contain; }
        .product-info { padding: 20px; text-align: center; flex-grow: 1; }
        .product-title { font-family: 'Teko', sans-serif; font-size: 1.6em; color: #fff; margin: 10px 0; }
        .product-price { color: #e10600; font-weight: bold; font-size: 1.3em; margin-bottom: 15px; }
        .add-btn { width: 100%; padding: 10px; background: #333; color: white; border: none; font-family: 'Teko', sans-serif; font-size: 1.2em; cursor: pointer; transition: 0.3s; }
        .add-btn:hover { background: #e10600; }

        /* --- MODAL DE ÉXITO --- */
        #success-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center; z-index: 2000; }
        .modal-content { background: #1a1b1e; padding: 40px; border-top: 5px solid #e10600; text-align: center; max-width: 450px; }
        .success-icon { font-size: 60px; color: #2ecc71; margin-bottom: 20px; }

        /* --- OTROS --- */
        #floating-cart { position: fixed; top: 0; right: -400px; width: 350px; height: 100%; background: #111; z-index: 1500; padding: 20px; transition: 0.4s; border-left: 5px solid #e10600; }
        #floating-cart.open { right: 0; }
        .checkout-section { display: none; padding: 50px 0; }
        footer { padding: 40px 0; text-align: center; background: #0a0a0a; border-top: 3px solid #222; }
    </style>
</head>
<body>

<header>
    <div class="container">
        <nav class="navbar">
            <div class="logo">SKILLET STORE</div>
            <ul class="nav-links">
                <li><a href="index.html">Principal</a></li>
                <li><a onclick="toggleCart()">Carrito <i class="fa-solid fa-cart-shopping"></i> <span id="cart-count">0</span></a></li>
            </ul>
        </nav>
    </div>
</header>

<section id="shop-section">
    <div class="container">
        <h2>Merchandising Oficial</h2>
        
        <div class="shop-controls">
            <input type="text" id="productSearch" class="search-box" placeholder="Buscar producto (ej: Vinilo, Monster...)" onkeyup="buscarProductos()">
            
            <div class="filter-container">
                <button class="filter-btn active" onclick="filtrarProductos('todos', event)">Todos</button>
                <button class="filter-btn" onclick="filtrarProductos('ropa', event)">Ropa</button>
                <button class="filter-btn" onclick="filtrarProductos('musica', event)">Música</button>
                <button class="filter-btn" onclick="filtrarProductos('accesorios', event)">Accesorios</button>
            </div>
        </div>

        <div class="products-grid" id="contenedor-productos"></div>
    </div>
</section>

<section id="checkout-form" class="checkout-section">
    <div class="container">
        <div style="display: flex; justify-content: center; margin-bottom: 40px; font-family: 'Teko', sans-serif;">
            <div style="text-align: center; color: #555; padding: 0 20px;">1. CARRITO</div>
            <div style="color: #e10600; padding: 0 10px;">➔</div>
            <div style="text-align: center; color: #fff; border-bottom: 2px solid #e10600; padding: 0 20px;">2. PAGO SEGURO</div>
        </div>

        <div style="display:grid; grid-template-columns: 1.5fr 1fr; gap:30px;">
            
            <div>
                <div style="background:#1a1b1e; padding:30px; border-top:3px solid #e10600; margin-bottom: 20px;">
                    <h3 style="font-family: 'Teko', sans-serif; font-size: 1.8em; margin-bottom: 15px;"><i class="fa-solid fa-truck"></i> DATOS DE ENVÍO</h3>
                    <input type="text" placeholder="Nombre completo" required style="width:100%; padding:12px; margin:8px 0; background:#0d0d0f; border:1px solid #333; color:#fff;">
                    <input type="email" placeholder="Email" required style="width:100%; padding:12px; margin:8px 0; background:#0d0d0f; border:1px solid #333; color:#fff;">
                    <input type="text" placeholder="Dirección de entrega" required style="width:100%; padding:12px; margin:8px 0; background:#0d0d0f; border:1px solid #333; color:#fff;">
                </div>

                <div style="background:#1a1b1e; padding:30px; border-top:3px solid #e10600;">
                    <h3 style="font-family: 'Teko', sans-serif; font-size: 1.8em; margin-bottom: 15px;"><i class="fa-solid fa-credit-card"></i> MÉTODO DE PAGO</h3>
                    <input type="text" id="card-num" placeholder="Número de tarjeta (16 dígitos)" required pattern="\d{16}" maxlength="16" style="width:100%; padding:12px; margin:8px 0; background:#0d0d0f; border:1px solid #333; color:#fff;">
                    <div style="display:flex; gap:10px;">
                        <input type="text" placeholder="MM/AA" required pattern="(0[1-9]|1[0-2])\/[0-9]{2}" maxlength="5" style="flex:1; padding:12px; background:#0d0d0f; border:1px solid #333; color:#fff;">
                        <input type="text" placeholder="CVV" required pattern="\d{3}" maxlength="3" style="flex:1; padding:12px; background:#0d0d0f; border:1px solid #333; color:#fff;">
                    </div>
                    
                    <div style="margin-top: 20px; font-size: 1.5em; color: #444; display: flex; gap: 15px;">
                        <i class="fa-brands fa-cc-visa"></i>
                        <i class="fa-brands fa-cc-mastercard"></i>
                        <i class="fa-brands fa-cc-paypal"></i>
                        <i class="fa-brands fa-cc-apple-pay"></i>
                    </div>
                </div>
            </div>

            <div style="background:#141416; padding:30px; border: 1px solid #333; height: fit-content;">
                <h3 style="font-family: 'Teko', sans-serif; font-size: 1.8em; border-bottom: 1px solid #333; padding-bottom: 10px;">RESUMEN</h3>
                
                <div id="checkout-summary-items" style="margin: 20px 0; max-height: 300px; overflow-y: auto;">
                    </div>

                <div style="border-top: 1px solid #333; padding-top: 15px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>Subtotal:</span>
                        <span id="summary-subtotal">0€</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>Envío:</span>
                        <span>5.00€</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 15px; font-weight: bold; font-size: 1.4em; color: #e10600;">
                        <span>TOTAL:</span>
                        <span id="final-price-display-checkout">0€</span>
                    </div>
                </div>

                <button class="add-btn" style="padding:15px; margin-top:25px; font-size: 1.4em;" onclick="procesarPago()">
                    FINALIZAR COMPRA
                </button>
                <p style="font-size: 0.7em; color: #555; text-align: center; margin-top: 15px;">
                    <i class="fa-solid fa-lock"></i> Pago encriptado de seguridad 256-bit SSL
                </p>
            </div>

        </div>
    </div>
</section>
<div id="floating-cart">
    <h3>Tu Carrito</h3>
    <div id="cart-items-container" style="margin:20px 0;"></div>
    <button class="add-btn" onclick="goToCheckout()">IR AL PAGO</button>
    <button class="add-btn" style="background:#444; margin-top:10px;" onclick="toggleCart()">CERRAR</button>
</div>

<div id="success-modal">
    <div class="modal-content">
        <div class="success-icon"><i class="fa-solid fa-circle-check"></i></div>
        <h3>¡PAGO COMPLETADO!</h3>
        <p>Gracias por tu compra. Recibirás un email de confirmación.</p>
        <button class="add-btn" style="margin-top:20px;" onclick="location.reload()">VOLVER A LA TIENDA</button>
    </div>
</div>

<footer><p>© 2025 Skillet Merch. Diseñado para Panheads.</p></footer>

<script>
        let productos = []; 
        let carrito = [];

        // 1. CARGA DE DATOS DESDE EL JSON
        async function cargarBaseDeDatos() {
            try {
                const respuesta = await fetch('productos.json'); 
                if (!respuesta.ok) throw new Error("No se pudo encontrar el archivo JSON");
                const datos = await respuesta.json();
                productos = datos.productos; 
                mostrarProductos(productos); 
            } catch (error) {
                console.error("Error crítico:", error);
                alert("Error al cargar productos. Revisa que el archivo productos.json no tenga errores de comas.");
            }
        }

        // 2. MOSTRAR PRODUCTOS (Con lógica de Ofertas)
        function mostrarProductos(lista) {
            const contenedor = document.getElementById('contenedor-productos');
            contenedor.innerHTML = '';
            lista.forEach(p => {
                // Si el producto tiene 'oferta: true', creamos el HTML del precio tachado
                const precioViejoHTML = p.oferta ? `<span style="text-decoration: line-through; color: #777; font-size: 0.8em; margin-right: 10px;">${p.precioAnterior.toFixed(2)}€</span>` : '';
                
                contenedor.innerHTML += `
                    <div class="product-card">
                        <div class="product-img-container"><img src="${p.imagen}"></div>
                        <div class="product-info">
                            <p style="color:#e10600; font-size:0.8em; text-transform:uppercase;">${p.categoria}</p>
                            <h3 class="product-title">${p.nombre}</h3>
                            <p class="product-price">
                                ${precioViejoHTML}
                                ${p.precio.toFixed(2)}€
                            </p>
                            <button class="add-btn" onclick="agregarAlCarrito(${p.id})">AGREGAR</button>
                        </div>
                    </div>`;
            });
        }

        // 3. FILTRAR PRODUCTOS (Incluye categoría de Ofertas)
        function filtrarProductos(cat, e) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            e.target.classList.add('active');

            if (cat === 'todos') {
                mostrarProductos(productos);
            } else if (cat === 'ofertas') {
                const enOferta = productos.filter(p => p.oferta === true);
                mostrarProductos(enOferta);
            } else {
                mostrarProductos(productos.filter(p => p.categoria === cat));
            }
        }

        // 4. BÚSQUEDA
        function buscarProductos() {
            const busqueda = document.getElementById('productSearch').value.toLowerCase();
            const filtrados = productos.filter(p => p.nombre.toLowerCase().includes(busqueda));
            mostrarProductos(filtrados);
        }

        // 5. GESTIÓN DEL CARRITO
        function toggleCart() { document.getElementById('floating-cart').classList.toggle('open'); }

        function agregarAlCarrito(id) {
            const p = productos.find(x => x.id === id);
            carrito.push(p);
            document.getElementById('cart-count').textContent = carrito.length;
            renderCarrito();
            if(!document.getElementById('floating-cart').classList.contains('open')) toggleCart();
        }

        function renderCarrito() {
            const cont = document.getElementById('cart-items-container');
            let total = 0;
            cont.innerHTML = '';
            carrito.forEach(p => {
                total += p.precio;
                cont.innerHTML += `<p style="color:white; margin-bottom:5px; font-size:0.9em;">${p.nombre} - ${p.precio.toFixed(2)}€</p>`;
            });
            document.getElementById('final-price-display').textContent = (total + 5).toFixed(2) + '€';
        }

        function goToCheckout() {
            if(carrito.length === 0) return alert("El carrito está vacío");
            toggleCart();
            document.getElementById('shop-section').style.display = 'none';
            document.getElementById('checkout-form').style.display = 'block';
        }

        function procesarPago() {
            const inputs = document.querySelectorAll('#checkout-form input[required]');
            let ok = true;
            inputs.forEach(i => { if(!i.checkValidity()) { i.reportValidity(); ok = false; } });
            if(ok) document.getElementById('success-modal').style.display = 'flex';
        }

        // INICIALIZACIÓN
        cargarBaseDeDatos();
    </script>
</body>
</html>