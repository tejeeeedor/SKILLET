<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Oficial Skillet</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Estilos generales */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #0a0a0a;
            color: #f0f0f0;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header de Tienda */
        .store-header {
            background: linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.9)), 
                        url('https://i.scdn.co/image/ab67616d0000b2735d3963ed253465edbed6f7d1');
            background-size: cover;
            background-position: center;
            padding: 40px 0;
            text-align: center;
            border-bottom: 3px solid #e10600;
        }
        
        .store-header h1 {
            font-size: 3rem;
            color: #e10600;
            margin-bottom: 10px;
        }
        
        .store-header p {
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto 30px;
        }
        
        .back-btn {
            display: inline-block;
            background-color: #333;
            color: white;
            padding: 10px 25px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            margin-right: 10px;
        }
        
        .back-btn:hover {
            background-color: #444;
            transform: translateY(-3px);
        }
        
        /* Filtros */
        .filters {
            background-color: #111;
            padding: 20px 0;
            margin-bottom: 30px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .filter-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .filter-btn {
            background-color: #1a1a1a;
            color: #f0f0f0;
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background-color: #e10600;
            color: white;
        }
        
        /* Grid de Productos */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
            padding: 20px 0 60px;
        }
        
        .product-card {
            background-color: #1a1a1a;
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .product-img {
            height: 250px;
            background-color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            color: #e10600;
            position: relative;
            overflow: hidden;
        }
        
        .product-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #e10600;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .badge-new {
            background-color: #00a8ff;
        }
        
        .badge-sale {
            background-color: #e10600;
        }
        
        .badge-limited {
            background-color: #9c88ff;
        }
        
        .product-info {
            padding: 20px;
        }
        
        .product-category {
            color: #aaa;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }
        
        .product-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: #f0f0f0;
        }
        
        .product-description {
            color: #aaa;
            font-size: 0.9rem;
            margin-bottom: 15px;
            min-height: 60px;
        }
        
        .product-price {
            color: #e10600;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .product-old-price {
            color: #777;
            text-decoration: line-through;
            font-size: 1rem;
            margin-left: 10px;
        }
        
        .btn {
            display: inline-block;
            background-color: #e10600;
            color: white;
            padding: 12px 30px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            width: 100%;
        }
        
        .btn:hover {
            background-color: #b30500;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(225, 6, 0, 0.4);
        }
        
        /* Carrito de Compras */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 350px;
            height: 100vh;
            background-color: #111;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            transition: right 0.3s;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .cart-sidebar.active {
            right: 0;
        }
        
        .cart-content-wrapper {
            flex-grow: 1;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }
        
        .cart-items {
            flex-grow: 1;
            margin-bottom: 20px;
        }
        
        .cart-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #222;
        }
        
        .cart-item-img {
            width: 60px;
            height: 60px;
            background-color: #333;
            margin-right: 10px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            color: #e10600;
        }
        
        .cart-item-info {
            flex: 1;
        }
        
        .cart-item-title {
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .cart-item-price {
            color: #e10600;
            font-weight: bold;
        }
        
        .cart-quantity-controls {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }

        .cart-quantity-controls button {
            background-color: #333;
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 3px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .cart-quantity-controls button:hover {
            background-color: #e10600;
        }

        .cart-quantity-controls span {
            margin: 0 10px;
            font-size: 1em;
            width: 20px;
            text-align: center;
        }

        .remove-item-btn {
            background: none;
            border: none;
            color: #777;
            font-size: 1.1rem;
            margin-left: 10px;
            cursor: pointer;
            transition: color 0.2s;
        }

        .remove-item-btn:hover {
            color: #e10600;
        }

        .cart-summary {
            padding-top: 20px;
            border-top: 1px solid #333;
        }
        
        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .cart-total span {
            color: #e10600;
        }
        
        .close-cart {
            background: none;
            border: none;
            color: #f0f0f0;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* Cart Icon */
        .cart-icon {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: #e10600;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 999;
            box-shadow: 0 4px 10px rgba(225, 6, 0, 0.3);
            transition: background-color 0.3s;
        }
        
        .cart-icon:hover {
            background-color: #b30500;
        }

        .cart-count-icon {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #fff;
            color: #e10600;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        /* Footer de Tienda */
        .store-footer {
            background-color: #111;
            padding: 40px 0;
            text-align: center;
            border-top: 1px solid #333;
        }
        
        .payment-methods {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            font-size: 2rem;
            color: #666;
        }
        
        .store-info {
            color: #777;
            font-size: 0.9rem;
            margin-top: 20px;
        }

        /* --- ESTILOS DE CHECKOUT Y CONFIRMACIÓN AÑADIDOS --- */

        .screen {
            min-height: 100vh;
            padding: 50px 0;
            display: none; /* Por defecto están ocultos */
        }
        
        .screen.active {
            display: block;
        }

        .checkout-form-container {
            max-width: 700px;
            margin: 0 auto;
            background-color: #1a1a1a;
            padding: 30px;
            border-radius: 10px;
        }
        
        .checkout-form-container h2 {
            color: #e10600;
            margin-bottom: 30px;
            text-align: center;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
            font-weight: bold;
        }

        .checkout-form-container input[type="text"],
        .checkout-form-container input[type="email"],
        .checkout-form-container input[type="tel"],
        .checkout-form-container select { /* Añadido SELECT aquí */
            width: 100%;
            padding: 12px;
            border: 1px solid #333;
            border-radius: 5px;
            background-color: #222;
            color: white;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        
        .checkout-form-container select {
            /* Estilos específicos para la flecha del select */
            -webkit-appearance: none;
            -moz-appearance: none;    
            appearance: none;         
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23cccccc%22%20d%3D%22M287%2095.6L146.2%20236.4%205.4%2095.6H287z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px top 50%;
            background-size: 10px;
        }

        .checkout-form-container input:focus,
        .checkout-form-container select:focus {
            outline: none;
            border-color: #e10600;
        }

        .error-message {
            color: #e10600;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .payment-details {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }

        .payment-details .form-group:last-child {
            grid-column: 2 / 3;
        }

        .checkout-summary {
            padding: 20px;
            margin-top: 30px;
            background-color: #222;
            border-radius: 8px;
            text-align: center;
        }
        
        .checkout-summary h3 {
            color: white;
            margin-bottom: 10px;
        }

        #checkoutTotal {
            color: #00a8ff;
            font-size: 1.8rem;
            font-weight: bold;
        }

        /* Estilos de Confirmación */
        .confirmation-box {
            max-width: 600px;
            margin: 0 auto;
            background-color: #1a1a1a;
            padding: 40px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e10600;
        }

        .confirmation-box i {
            font-size: 4rem;
            color: #00a8ff;
            margin-bottom: 20px;
        }

        .confirmation-box h2 {
            color: #f0f0f0;
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .confirmation-box p {
            font-size: 1.1rem;
            color: #ccc;
            margin-bottom: 10px;
        }

        .confirmation-box strong {
            color: #e10600;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .payment-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="storeScreen">
        <header class="store-header">
            <div class="container">
                <h1>TIENDA OFICIAL SKILLET</h1>
                <p>Productos oficiales y exclusivos de la banda. Envíos a todo el mundo.</p>
                <div>
                    <a href="index.html" class="back-btn">Volver a la Web</a>
                    <button class="btn" onclick="toggleCart()">Ver Carrito (<span id="cartCount">0</span>)</button>
                </div>
            </div>
        </header>

        <section class="filters">
            <div class="container">
                <div class="filter-container">
                    <button class="filter-btn active" onclick="filterProducts('all', this)">Todos</button>
                    <button class="filter-btn" onclick="filterProducts('vinilos', this)">Vinilos</button>
                    <button class="filter-btn" onclick="filterProducts('cds', this)">CDs</button>
                    <button class="filter-btn" onclick="filterProducts('ropa', this)">Ropa</button>
                    <button class="filter-btn" onclick="filterProducts('accesorios', this)">Accesorios</button>
                    <button class="filter-btn" onclick="filterProducts('paquetes', this)">Paquetes</button>
                    <button class="filter-btn" onclick="filterProducts('ofertas', this)">Ofertas</button>
                </div>
            </div>
        </section>

        <section class="products">
            <div class="container">
                <div class="products-grid" id="productsGrid">
                    
                    <div class="product-card" data-category="vinilos">
                        <div class="product-img">
                            <i class="fas fa-record-vinyl"></i>
                            <div class="product-badge badge-limited">Limitado</div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Vinilos</div>
                            <h3 class="product-title">Vinilo "Awake" (180g Negro)</h3>
                            <p class="product-description">Edición en vinilo negro de 180g. Incluye póster.</p>
                            <div class="product-price">$32.99</div>
                            <button class="btn add-to-cart-btn" data-id="101" data-name='Vinilo "Awake"' data-price="32.99" data-img-icon='<i class="fas fa-record-vinyl"></i>'>Añadir al Carrito</button>
                        </div>
                    </div>
                    
                    <div class="product-card" data-category="ropa">
                        <div class="product-img">
                            <i class="fas fa-tshirt"></i>
                            <div class="product-badge badge-new">Nuevo</div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Ropa</div>
                            <h3 class="product-title">Camiseta "Monster" Tour 2024</h3>
                            <p class="product-description">Diseño exclusivo de la gira 2024. 100% algodón, tallas S-XXL.</p>
                            <div class="product-price">$24.99</div>
                            <button class="btn add-to-cart-btn" data-id="301" data-name='Camiseta "Monster" Tour 2024' data-price="24.99" data-img-icon='<i class="fas fa-tshirt"></i>'>Añadir al Carrito</button>
                        </div>
                    </div>
                    
                    <div class="product-card" data-category="cds" data-ofertas="true">
                        <div class="product-img">
                            <i class="fas fa-compact-disc"></i>
                            <div class="product-badge badge-sale">-25%</div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">CDs</div>
                            <h3 class="product-title">Pack 3 CDs Clásicos</h3>
                            <p class="product-description">"Skillet", "Hey You" y "Invincible". Perfecto para coleccionistas.</p>
                            <div class="product-price">$29.99 <span class="product-old-price">$39.99</span></div>
                            <button class="btn add-to-cart-btn" data-id="205" data-name='Pack 3 CDs Clásicos' data-price="29.99" data-img-icon='<i class="fas fa-compact-disc"></i>'>Añadir al Carrito</button>
                        </div>
                    </div>
                    
                    <div class="product-card" data-category="accesorios">
                        <div class="product-img">
                            <i class="fas fa-mug-hot"></i>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Accesorios</div>
                            <h3 class="product-title">Taza "Feel Invincible"</h3>
                            <p class="product-description">Taza de cerámica con diseño de la canción. Capacidad 350ml.</p>
                            <div class="product-price">$14.99</div>
                            <button class="btn add-to-cart-btn" data-id="401" data-name='Taza "Feel Invincible"' data-price="14.99" data-img-icon='<i class="fas fa-mug-hot"></i>'>Añadir al Carrito</button>
                        </div>
                    </div>
                    
                    <div class="product-card" data-category="paquetes">
                        <div class="product-img">
                            <i class="fas fa-box"></i>
                            <div class="product-badge">Más Vendido</div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Paquetes</div>
                            <h3 class="product-title">Paquete Fan Esencial</h3>
                            <p class="product-description">CD "Awake" + Camiseta básica + Pack stickers. Ahorro del 15%.</p>
                            <div class="product-price">$39.99</div>
                            <button class="btn add-to-cart-btn" data-id="501" data-name='Paquete Fan Esencial' data-price="39.99" data-img-icon='<i class="fas fa-box"></i>'>Añadir al Carrito</button>
                        </div>
                    </div>

                    <div class="product-card" data-category="vinilos">
                        <div class="product-img">
                            <i class="fas fa-record-vinyl"></i>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Vinilos</div>
                            <h3 class="product-title">Vinilo "Unleashed" (Doble LP)</h3>
                            <p class="product-description">Doble vinilo gatefold con letras y fotos exclusivas.</p>
                            <div class="product-price">$44.99</div>
                            <button class="btn add-to-cart-btn" data-id="103" data-name='Vinilo "Unleashed"' data-price="44.99" data-img-icon='<i class="fas fa-record-vinyl"></i>'>Añadir al Carrito</button>
                        </div>
                    </div>

                    <div class="product-card" data-category="cds">
                        <div class="product-img">
                            <i class="fas fa-compact-disc"></i>
                            <div class="product-badge badge-new">Nuevo</div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">CDs</div>
                            <h3 class="product-title">CD "Dominion" (Edición Deluxe)</h3>
                            <p class="product-description">Incluye 3 bonus tracks y digipak de lujo.</p>
                            <div class="product-price">$18.99</div>
                            <button class="btn add-to-cart-btn" data-id="201" data-name='CD "Dominion"' data-price="18.99" data-img-icon='<i class="fas fa-compact-disc"></i>'>Añadir al Carrito</button>
                        </div>
                    </div>

                    <div class="product-card" data-category="ropa">
                        <div class="product-img">
                            <i class="fas fa-hoodie"></i>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Ropa</div>
                            <h3 class="product-title">Sudadera con Capucha "Victorious"</h3>
                            <p class="product-description">Sudadera gruesa con logo bordado en el pecho.</p>
                            <div class="product-price">$49.99</div>
                            <button class="btn add-to-cart-btn" data-id="302" data-name='Sudadera "Victorious"' data-price="49.99" data-img-icon='<i class="fas fa-hoodie"></i>'>Añadir al Carrito</button>
                        </div>
                    </div>

                    <div class="product-card" data-category="accesorios" data-ofertas="true">
                        <div class="product-img">
                            <i class="fas fa-key"></i>
                            <div class="product-badge badge-sale">-10%</div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Accesorios</div>
                            <h3 class="product-title">Llavero Logo Skillet Metálico</h3>
                            <p class="product-description">Llavero de metal resistente con el logo de la banda.</p>
                            <div class="product-price">$8.99 <span class="product-old-price">$9.99</span></div>
                            <button class="btn add-to-cart-btn" data-id="402" data-name='Llavero Logo Metálico' data-price="8.99" data-img-icon='<i class="fas fa-key"></i>'>Añadir al Carrito</button>
                        </div>
                    </div>
                    
                </div>
            </div>
        </section>
    </div>
    
    <div class="screen" id="checkoutScreen">
        <div class="container">
            <div class="checkout-form-container">
                <h2>Finalizar Compra</h2>
                <form id="checkoutForm">
                    
                    <h3 style="color: #ccc; font-size: 1.3rem; margin-top: 15px; margin-bottom: 25px;">1. Información de Envío</h3>

                    <div class="form-group">
                        <label for="nombre">Nombre Completo</label>
                        <input type="text" id="nombre" name="nombre" placeholder="John Cooper" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" placeholder="tu.email@example.com" required>
                    </div>
                    <div class="form-group">
                        <label for="telefono">Teléfono</label>
                        <input type="tel" id="telefono" name="telefono" placeholder="Ej. 600 123 456" required 
                               pattern="[0-9]{9,15}" 
                               title="Introduce un número de teléfono válido (9 a 15 dígitos)">
                    </div>
                    
                    <div class="form-group">
                        <label for="direccion">Calle, Número, C.P. y Ciudad</label>
                        <input type="text" id="direccion" name="direccion" placeholder="Calle de la Música, 13, 28001 Madrid" required>
                    </div>

                    <div class="form-group">
                        <label for="pais">País</label>
                        <select id="pais" name="pais" required>
                            <option value="">-- Selecciona un País --</option>
                            <option value="ES">España</option>
                            <option value="MX">México</option>
                            <option value="CO">Colombia</option>
                            <option value="AR">Argentina</option>
                            <option value="PE">Perú</option>
                            <option value="CL">Chile</option>
                            <option value="VE">Venezuela</option>
                            <option value="US">Estados Unidos</option>
                            <option value="CA">Canadá</option>
                            <option value="UK">Reino Unido</option>
                            <option value="FR">Francia</option>
                            <option value="DE">Alemania</option>
                            <option value="IT">Italia</option>
                            <option value="PT">Portugal</option>
                            </select>
                    </div>

                    <h3 style="color: #ccc; font-size: 1.3rem; margin-top: 30px; margin-bottom: 25px;">2. Información de Pago (Simulada)</h3>

                    <div class="form-group">
                        <label for="card-number">Número de Tarjeta (16 dígitos)</label>
                        <input type="text" id="card-number" name="card-number" placeholder="xxxx xxxx xxxx xxxx" required 
                               maxlength="19" 
                               title="Formato: 4 dígitos seguidos de espacios (16 en total)">
                        <div class="error-message" id="cardError"></div>
                    </div>

                    <div class="payment-details">
                        <div class="form-group">
                            <label for="exp-date">Fecha de Expiración (MM/AA)</label>
                            <input type="text" id="exp-date" name="exp-date" placeholder="MM/AA" required 
                                   maxlength="5" 
                                   pattern="(0[1-9]|1[0-2])\/\d{2}" 
                                   title="Formato: MM/AA (Ej. 12/26)">
                        </div>
                        <div class="form-group">
                            <label for="cvc">CVC</label>
                            <input type="text" id="cvc" name="cvc" placeholder="CVC" required 
                                   maxlength="4" 
                                   pattern="\d{3,4}" 
                                   title="3 o 4 dígitos de seguridad">
                        </div>
                    </div>

                    <div class="checkout-summary">
                        <h3>Total a Pagar</h3>
                        <div id="checkoutTotal">$0.00</div>
                    </div>
                    
                    <button type="submit" class="btn" style="width: 100%; margin-top: 20px;">
                        <i class="fa-solid fa-lock"></i> Confirmar Pago
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div class="screen" id="confirmationScreen">
        <div class="container">
            <div class="confirmation-box">
                <i class="fa-solid fa-circle-check"></i>
                <h2>¡Pago Confirmado!</h2>
                <p>Tu pedido ha sido procesado con éxito.</p>
                <p>Número de Pedido: <strong id="orderId">#SKL-0000</strong></p>
                <p>Total Pagado: <strong id="confirmedTotal">$0.00</strong></p>
                <p>Recibirás una confirmación por email en: <strong id="confirmedEmail">email@ejemplo.com</strong></p>
                <p>Se enviará a: <strong id="confirmedAddress"></strong></p> 
                
                <button class="btn" onclick="showStore()" style="width: auto; margin-top: 30px;">
                    <i class="fa-solid fa-house"></i> Volver a la Tienda
                </button>
            </div>
        </div>
    </div>

    <div class="cart-icon" onclick="toggleCart()">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-count-icon" id="floatingCartCount">0</span>
    </div>

    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-content-wrapper">
            <div class="cart-header">
                <h2>Carrito</h2>
                <button class="close-cart" onclick="toggleCart()"><i class="fas fa-times"></i></button>
            </div>
            
            <div class="cart-items" id="cartItemsContainer">
                <p id="emptyCartMessage" style="color: #777; text-align: center;">Tu carrito está vacío.</p>
            </div>
        </div>

        <div class="cart-summary">
            <div class="cart-total">
                <span>Subtotal:</span>
                <span id="cartSubtotal">$0.00</span>
            </div>
            <button class="btn" onclick="startCheckout()" style="width: 100%;">Finalizar Compra</button>
        </div>
    </div>

    <footer class="store-footer">
        <div class="container">
            <p>&copy; 2024 Tienda Oficial Skillet. Todos los derechos reservados.</p>
            <div class="payment-methods">
                <i class="fab fa-cc-visa"></i>
                <i class="fab fa-cc-mastercard"></i>
                <i class="fab fa-cc-paypal"></i>
                <i class="fab fa-cc-amex"></i>
            </div>
            <div class="store-info">
                Diseño fan-made no oficial. Todos los derechos de marca e imágenes pertenecen a Skillet.
            </div>
        </div>
    </footer>

    <script>
        // --- 1. CONFIGURACIÓN INICIAL DEL CARRITO ---
        let cart = []; // Array que contendrá los objetos del carrito
        const SHIPPING_COST = 5.00; // Simulación de coste de envío

        // Elementos del DOM
        const cartSidebar = document.getElementById('cartSidebar');
        const cartItemsContainer = document.getElementById('cartItemsContainer');
        const cartCountHeader = document.getElementById('cartCount');
        const floatingCartCount = document.getElementById('floatingCartCount');
        const cartSubtotalElement = document.getElementById('cartSubtotal');
        const emptyCartMessage = document.getElementById('emptyCartMessage');
        const checkoutScreen = document.getElementById('checkoutScreen');
        const confirmationScreen = document.getElementById('confirmationScreen');

        // --- 2. FUNCIONES PRINCIPALES DEL CARRITO ---

        function toggleCart() {
            cartSidebar.classList.toggle('active');
        }

        function updateCart() {
            cartItemsContainer.innerHTML = ''; // Limpiar contenido anterior
            let totalItems = 0;
            let subtotal = 0;

            if (cart.length === 0) {
                emptyCartMessage.style.display = 'block';
            } else {
                emptyCartMessage.style.display = 'none';
                
                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    subtotal += itemTotal;
                    totalItems += item.quantity;

                    const itemElement = document.createElement('div');
                    itemElement.classList.add('cart-item');
                    itemElement.innerHTML = `
                        <div class="cart-item-img">${item.imgIcon}</div>
                        <div class="cart-item-info">
                            <div class="cart-item-title">${item.name}</div>
                            <div class="cart-item-price">$${itemTotal.toFixed(2)}</div>
                            <div class="cart-quantity-controls">
                                <button onclick="changeQuantity(${item.id}, -1)">-</button>
                                <span>${item.quantity}</span>
                                <button onclick="changeQuantity(${item.id}, 1)">+</button>
                                <button class="remove-item-btn" onclick="removeItem(${item.id})"><i class="fa-solid fa-trash-can"></i></button>
                            </div>
                        </div>
                    `;
                    cartItemsContainer.appendChild(itemElement);
                });
            }

            // Actualizar contadores y totales
            cartCountHeader.textContent = totalItems;
            floatingCartCount.textContent = totalItems;
            cartSubtotalElement.textContent = `$${subtotal.toFixed(2)}`;

            // Guardar el carrito en localStorage para persistencia
            localStorage.setItem('skilletCart', JSON.stringify(cart));
        }

        function addToCart(product) {
            // Convertimos el ID a número al añadirlo para evitar problemas
            const numericId = parseInt(product.id); 

            const existingItem = cart.find(item => item.id === numericId);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                // Aseguramos que el ID del objeto en el carrito es un número
                cart.push({ ...product, id: numericId, quantity: 1 });
            }

            updateCart();
            toggleCart(); // Abrir el carrito automáticamente
        }

        function changeQuantity(id, change) {
            // AHORA EL ID VIENE COMO NÚMERO DIRECTAMENTE DE LOS BOTONES DEL CARRITO
            const item = cart.find(item => item.id === id); // El ID ya es un número en el array
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeItem(id);
                } else {
                    updateCart();
                }
            }
        }

        function removeItem(id) {
            cart = cart.filter(item => item.id !== id);
            updateCart();
        }

        // --- 3. MANEJO DE EVENTOS ---

        // Asignar eventos de clic a todos los botones 'Añadir al Carrito'
        document.querySelectorAll('.add-to-cart-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                const product = {
                    // ID se pasa como string desde el data-attribute
                    id: e.currentTarget.dataset.id, 
                    name: e.currentTarget.dataset.name,
                    price: parseFloat(e.currentTarget.dataset.price),
                    imgIcon: e.currentTarget.dataset.imgIcon
                };
                addToCart(product);
            });
        });

        // Evento de filtro
        function filterProducts(category, button) {
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');

            const products = document.querySelectorAll('.product-card');

            products.forEach(product => {
                const productCategory = product.dataset.category;
                const isOffer = product.hasAttribute('data-ofertas');

                if (category === 'all') {
                    product.style.display = 'block';
                } else if (category === 'ofertas') {
                    product.style.display = isOffer ? 'block' : 'none';
                } else {
                    product.style.display = (productCategory === category) ? 'block' : 'none';
                }
            });
        }

        // Cargar carrito desde localStorage al inicio
        window.onload = () => {
            const storedCart = localStorage.getItem('skilletCart');
            if (storedCart) {
                const tempCart = JSON.parse(storedCart);
                // Aseguramos que los IDs se conviertan a números al cargar
                cart = tempCart.map(item => ({
                    ...item,
                    id: parseInt(item.id) 
                }));
                updateCart();
            }
            // Asegurar que solo la tienda es visible al inicio
            showStore();
        };

        // --- 4. FUNCIONALIDAD DE CHECKOUT Y CONFIRMACIÓN ---

        function startCheckout() {
            if (cart.length === 0) {
                alert("El carrito está vacío. Añade productos para continuar.");
                return;
            }
            toggleCart(); // Cierra el carrito
            
            // Muestra la pantalla de checkout y oculta las demás
            document.getElementById('storeScreen').style.display = 'none';
            checkoutScreen.classList.add('active');
            confirmationScreen.classList.remove('active');
            
            // Calcular y mostrar el total (Subtotal + Envío simulado)
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const total = subtotal + SHIPPING_COST;
            document.getElementById('checkoutTotal').textContent = `$${total.toFixed(2)} (Incl. Envío $${SHIPPING_COST.toFixed(2)})`;
            window.scrollTo(0, 0);
        }

        document.getElementById('checkoutForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validación final de tarjeta de 16 dígitos
            const cardNumber = document.getElementById('card-number').value.replace(/\s/g, '');
            if (cardNumber.length !== 16) {
                alert("Por favor, introduce un número de tarjeta válido de 16 dígitos.");
                return;
            }
            
            // Validación de país 
            const paisSelect = document.getElementById('pais');
            const paisSeleccionadoTexto = paisSelect.options[paisSelect.selectedIndex].text;
            
            if (!paisSelect.value) {
                alert("Por favor, selecciona tu país de la lista.");
                return;
            }

            // Simulación de envío de datos
            const email = document.getElementById('email').value;
            const direccionBase = document.getElementById('direccion').value;

            // Ocultar checkout y mostrar confirmación
            checkoutScreen.classList.remove('active');
            confirmationScreen.classList.add('active');
            
            // Actualizar detalles de la confirmación
            const finalTotal = document.getElementById('checkoutTotal').textContent.split('(')[0].trim();
            document.getElementById('confirmedTotal').textContent = finalTotal;
            document.getElementById('confirmedEmail').textContent = email;
            document.getElementById('orderId').textContent = `#SKL-${Math.floor(Math.random() * 10000) + 1000}`; // ID Aleatorio
            
            // MOSTRAR DIRECCIÓN COMPLETA EN LA CONFIRMACIÓN
            document.getElementById('confirmedAddress').textContent = `${direccionBase} (${paisSeleccionadoTexto})`;

            // Limpiar carrito después de la compra
            cart = [];
            localStorage.removeItem('skilletCart');
            updateCart();
            window.scrollTo(0, 0);
        });

        function showStore() {
            document.getElementById('storeScreen').style.display = 'block';
            checkoutScreen.classList.remove('active');
            confirmationScreen.classList.remove('active');
            window.scrollTo(0, 0);
        }

        // --- 5. VALIDACIÓN Y FORMATO DEL FORMULARIO DE PAGO ---

        // Ejecutar las validaciones después de que el DOM esté listo
        document.addEventListener('DOMContentLoaded', () => {
            const cardNumberInput = document.getElementById('card-number');
            const cardError = document.getElementById('cardError');
            const expDateInput = document.getElementById('exp-date');

            if (cardNumberInput && cardError) {
                cardNumberInput.addEventListener('input', function(e) {
                    let input = e.target.value.replace(/\D/g, ''); // Solo permitir dígitos
                    let formattedInput = '';

                    // 1. Formato 4 en 4
                    for (let i = 0; i < input.length; i++) {
                        if (i > 0 && i % 4 === 0) {
                            formattedInput += ' ';
                        }
                        formattedInput += input[i];
                    }

                    e.target.value = formattedInput;

                    // 2. Validación en tiempo real
                    const cleanNumber = input.substring(0, 16); // Máximo 16 dígitos

                    if (cleanNumber.length > 0 && cleanNumber.length < 16) {
                        cardError.textContent = 'El número de tarjeta debe tener 16 dígitos.';
                        cardNumberInput.setCustomValidity('Inválido');
                    } else if (cleanNumber.length === 16) {
                        cardError.textContent = '';
                        cardNumberInput.setCustomValidity('');
                    } else {
                        cardError.textContent = '';
                        cardNumberInput.setCustomValidity('');
                    }
                });
            }

            // Formato de la fecha de expiración para MM/AA
            if (expDateInput) {
                expDateInput.addEventListener('input', function(e) {
                    let input = e.target.value.replace(/\D/g, '');
                    let formattedInput = '';

                    if (input.length > 0) {
                        formattedInput = input.substring(0, 2);
                    }
                    if (input.length > 2) {
                        formattedInput += '/' + input.substring(2, 4);
                    }

                    e.target.value = formattedInput;
                });
            }
        });
    </script>
</body>
</html>